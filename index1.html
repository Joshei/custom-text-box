<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <canvas
      id="canvas_id"
      width="220"
      height="240"
      style="border: 1px solid #550233"
      ;

      
    ></canvas>
    <button id="button1" onclick="makeOneDimArray()">insert position 2</button>
    <button id="button2" onclick="deleteFormerCharacter()">delete</button>
    
    
    <div class="test"></div>

    <script>

      const VOFFSET = 25;
      const HOFFSET = 30;
      //nestedarray holds values with an array - 35 by 35
      var canvas = document.getElementById('canvas_id')

      let textBox = [[]]

      let rows = 35
      let cols = 35

      
      let ctx = canvas.getContext('2d')
      // Set display size (css pixels).
      //get width of canvasvar size = 300;
      var size = 220
      canvas.style.width = size + 'px'
      canvas.style.height = size + 'px'

      // Set actual size in memory (scaled to account for extra pixel density).
      var scale = window.devicePixelRatio // Change to 1 on retina screens to see blurry canvas.
      canvas.width = size * scale
      canvas.height = size * scale

      // Normalize coordinate system to use css pixels.
      ctx.scale(scale, scale)

      ctx.fillStyle = '#ffffff'
      ctx.fillRect(0, 0, 800, 800)
      ctx.fillStyle = '#000000'
      ctx.font = '3px Monospace'
      ctx.textAlign = 'center'
      ctx.textBaseline = 'middle'

      var x = size / 2
      var y = size / 2

      

      const nestedArray = Array.from({ length: rows }, () =>
        Array.from({ length: cols }, () => ' ')
      )

      
      function clearArray() {
        ctx.clearRect(0, 0, 100, 100)
        ctx.fillStyle = '#ffffff'
        ctx.fillRect(0, 0, canvas.width, canvas.height)
        ctx.fillStyle = '#000000'
      }

      function drawGrid() {
        //cols
        clearArray()
        ctx.fillStyle = 'black'
        //columns
        for (let i = 0; i < 35; i++) {
          //rows
          for (let j = 0; j < 35; j++) {
            //nestedArray[i][j] = "X";
            ctx.fillText(nestedArray[j][i], j * 5 + 25, i * 10 + 25)
          }
        }

        

        return 1
      }

      function deleteFormerCharacter(){

      
      //  change current cursor space to blank 
      //  change previous character with under score amd space
      
      nestedArray[(horizontalCursorPosition/5)-1][verticalCursorPosition] = '_';
      nestedArray[horizontalCursorPosition/5][verticalCursorPosition/10] = ' ';
      horizontalCursorPosition = horizontalCursorPosition -5; 

      drawGrid();
      


      }



      let oneDimArray = [];
      //temp out of class

      let flag = false;
      function makeOneDimArray() {
        for (let i = 0; i < 35; i = i + 1) {
          //rows
          for (let j = 0; j < 35; j = j + 1) {
            oneDimArray.push(nestedArray[j][i])
          }
        }
        
        insertCharacter();

        
      }

      function insertCharacter(){
        console.log("2: ", oneDimArray);
       
      //oneDimArray.splice((horizontalCursorPosition/5+35  ),0, 'Z'); 
      oneDimArray.splice((horizontalCursorPosition/5+(35 * verticalCursorPosition/10)  ),0, 'Z');
      console.log("h: ", horizontalCursorPosition);
      console.log("v: ", verticalCursorPosition);
      console.log("3: ", oneDimArray);      
      makeTwoDimArrayWithInsertion();
      }


      let a = 0;
      let z =0;
      function makeTwoDimArrayWithInsertion(){
        for (let i = 0; i < 35; i = i + 1) {
          
          
          //rows
          //a++;
          for (j = 0; j < 35; j = j + 1, z++) {
          console.log("i: ", i);
          console.log("j: ", j);
          //set array with ints
          nestedArray[j][i] = oneDimArray[z];
          //a++;
        }     
        }  //  i = rows, j = col
        z=0;
       console.log("A: ", nestedArray);
       console.log("B: ", oneDimArray);


        drawGrid();
        CursorMovements.drawCursor(horizontalCursorPosition+ HOFFSET, verticalCursorPosition + VOFFSET);


        

/*
        //Tested arrays here!
        for (let i = 0; i < 35; i = i + 1) {
          //rows
          for (let j = 0; j < 35; j = j + 1) {
            //pushes nestedArray into onedimarray
            oneDimArray.push(nestedArray[j][i]);

            //console.log(oneDimArray);// - correct
          }
       }
       
        console.log(oneDimArray);// - correct
        // oneDimArray();
*/
      }


      
      let horizontalCursorPosition = 0
      let verticalCursorPosition = 0

      class InsertCharacters{

        constructor(){

          
        }
        

      
      insertTextRight() {
        
        let oneDimArray = []
      }


      }



      class  CursorMovementsClass{

        
        cursorRight() {
          /// console.log(horizontalCursorPosition);
          //if (horizontalCursorPosition >= 195){
          //    //alert(horizontalCursorPosition);
          //    horizontalCursorPosition = 195;
          //    return(-1);
          //}

          drawGrid(100, 100)
          horizontalCursorPosition = horizontalCursorPosition + 5;
          this.drawCursor(
            horizontalCursorPosition + HOFFSET,
            verticalCursorPosition + VOFFSET
          )
        }

        cursorLeft() {
          // console.log(horizontalCursorPosition);
          // if (horizontalCursorPosition <= 25){
          //     horizontalCursorPosition = 25;
          //     return(-1);
          // }

          drawGrid(100, 100)
          horizontalCursorPosition = horizontalCursorPosition - 5;

          this.drawCursor(
            horizontalCursorPosition + HOFFSET,
            verticalCursorPosition + VOFFSET)
        }
        cursorUp() {
          //if(verticalCursorPosition <= 25){
          //    verticalCursorPosition = 25;
          //    return(-1);
          //}
          drawGrid(100, 100)
          verticalCursorPosition = verticalCursorPosition - 10;
          
          this.drawCursor(
            horizontalCursorPosition + HOFFSET,
            verticalCursorPosition + VOFFSET)
          
        }
        cursorDown() {
          //alert(verticalCursorPosition);
          //if(verticalCursorPosition >= 195)
          //{
          //    verticalCursorPosition = 195;
          //    return(-1);
          //}

          drawGrid(100, 100)
          verticalCursorPosition = verticalCursorPosition + 10;
          this.drawCursor(
            horizontalCursorPosition + HOFFSET,
            verticalCursorPosition + VOFFSET)
          
        }
        redrawGrid() {}
        drawCursor(x, y) {
          ctx.font = '10px Monospace'
          ctx.fillStyle = 'red'
          ctx.fillText('_', x-5 , y);
        }

      }
      
      
      class CustomBoxClass {
        constructor() {
          drawGrid()
          CursorMovements.drawCursor(25, 25)
        }

        controlInput(key) {
          if (key == 'ArrowLeft') {
            CursorMovements.cursorLeft()
            return -1
          } else if (key == 'ArrowRight') {
            CursorMovements.cursorRight()
            return -1
          }
          if (key == 'ArrowUp') {
            CursorMovements.cursorUp()
            return -1
          } else if (key == 'ArrowDown') {
            CursorMovements.cursorDown()
            return -1
          } else {
            printCharacter(key)
          }
        }

      }

      function printCharacter(key) {
        ctx.clearRect(0, 0, 300, 300)

        //nestedArray[horizontalCursorPosition / 5][verticalCursorPosition / 8] =
        //  'E'

        console.log('v ', verticalCursorPosition)
        console.log('h ', horizontalCursorPosition)

        //try setting nested array for drawgrid
        
          nestedArray[horizontalCursorPosition/5][verticalCursorPosition/10] = key
          
        
          
        drawGrid()
        
        horizontalCursorPosition = horizontalCursorPosition + 5
          CursorMovements.drawCursor(
          horizontalCursorPosition + HOFFSET,
          verticalCursorPosition + VOFFSET
        )
      }

      
      const CursorMovements = new CursorMovementsClass();
      const customBox1 = new CustomBoxClass();
      

      document.addEventListener('keydown', function (e) {
        
        let key = e.key
        customBox1.controlInput(key)
      })
    </script>
  </body>
</html>
