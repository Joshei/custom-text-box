<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <canvas
      id="canvas_id"
      width= "220"
      height="240"
      style="border: 1px solid #550233"
      ;
    ></canvas>
    <button id="button1" onclick="insertNow()">insert position 2</button>



    <div class = "test"></div>


    <script>
      var arrayContentLength = 0;
      
      var gX = 0;
      var cursorX = 0
      var gY = 20;
      var flag = 0;
      var  DELTAX = 5;
      var DELTAY = 5;


    var textArray = new Array();

   

      var canvas = document.getElementById('canvas_id')

      

      
    //var canvas = document.getElementById('canvas_id');
    let ctx = canvas.getContext('2d');
      // Set display size (css pixels).
      //get width of canvasvar size = 300;
      var size = 220;
      canvas.style.width = size + 'px';
      canvas.style.height = size + 'px';

      // Set actual size in memory (scaled to account for extra pixel density).
      var scale = window.devicePixelRatio; // Change to 1 on retina screens to see blurry canvas.
      canvas.width = size * scale;
      canvas.height = size * scale;

      // Normalize coordinate system to use css pixels.
      ctx.scale(scale, scale);

      ctx.fillStyle = '#ffffff';
      ctx.fillRect(0, 0, 300, 300);
      ctx.fillStyle = '#000000';
      ctx.font = '9px Monospace';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';

      var x = size / 2;
      var y = size / 2;

      

      var indexX = 0;
      var currentKeyPress = '';
      
      
      let wrapAtX = 20;
      const MAXWIDTH = 5; 

      var xValuetoInsertAt = 2;
      newArray = [];

      const insert = (arr, index, newItem) => [
      
        ...arr.slice(0, index),
        newItem,
        ...arr.slice(index)
        
    ]


    


  let cursorXAdjuster = 0;
class CustomBoxClass{

  //CursorMov = new CursorMovement();


setNulls(){
  for(let i=0; i < 1000 ; i++){

    textArray.push("");
    //onsole.log("array: ",textArray[i]);

 
}

//alert(textArray[1]);
}
      /////////

    controlInput(key) {

        if(key == "ArrowLeft")
        {
          this.moveLeft();
          return(-1);
        }
        else if(key == "ArrowRight")
        {
          this.moveRight();
          return(-1);
        }
        // a regular text character added
        else{

          textArray[arrayContentLength] =  key;
        
        gX = gX + 0;
        
        ctx.fillStyle = 'black';

        }

        
        arrayContentLength = arrayContentLength + 1;
        this.drawText();
      }




      clearArray() {
        ctx.clearRect(0,0,100,100);
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0,0, canvas.width, canvas.height);
        ctx.fillStyle = '#000000';
      }
      

      
      
      
      
      drawText(cursorMoved) {
        
       
        //this.clearArray();
        gX = 0;
        cursorX = 0;
        gY = 20;
        
        //loops through entire string
        for (let i = 0; i < arrayContentLength; i++) {


          //alert(i);
          //in here, at end 3,6,9,12 , etc.
          if((( i % 3000) == 0) && (i != "0")){
            
            
            
            gX = 0;
            gY = gY + DELTAY;
            
            ctx.fillText(textArray[i], gX, gY);
            
           
            //console.log("i2 " , gY );
          }
          else{

          //prints one character
          
          gX=gX + DELTAX; 
          cursorX = cursorX + DELTAX;
          
          ctx.fillText(textArray[i], gX, gY);
         
          console.log("1: " , textArray[i] );
          //console.log("gx", gX);
          
          
          }
          if(cursorMoved != "moved"){
          //cursorX = cursorX + 5;
          }

        }
        


        cursorX = cursorX + cursorXAdjuster;

        this.drawCursor();
        
        
        
        
      }



      
insertNow(){
        let con = insert(textArray, 1, '5');
        console.log("con",con.length);


        //for(var i = 0 , len =con.length; i < len; i++){
        //textArray[i] = con[i];
        //console.log("1", textArray);
        textArray = [...con];
      
        

          
        
        this.drawText();
      }

      


      //find positioning of cursor, gX is where the farthest positioing of text is
drawCursor(){
ctx.fillText('_', cursorX, gY+0);
}

drawCursor1(x,y){
//  ctx.fillStyle = '#000000';
//ctx.fillText('A', 20, 20);
ctx.fillText('_', 20 , gY+30);
alert("!");
}


  


      
      

  
      
  

  
 
    
 ////////////////

    moveRight(){
      if (textArray[cursorX+5] == null){
    return(-1);

}
      cursorX = cursorX + 5
   
  this.drawText("moved");

   // CustomBoxClass.drawText();


}  

moveLeft(){

  alert(((cursorX)/5 ));
  if ((((cursorX)/5)) % 10 == 0)
  {
    alert("11th space");
    this.drawCursor1(500,40);
  }
 cursorXAdjuster = cursorXAdjuster - 5;

this.drawText("moved");


}  
  
////////////////
}


  
  
  
 // const cursorMove = new CursorMovement ();

  const customBox1 = new CustomBoxClass ();

  customBox1.setNulls();
  

  document.addEventListener('keydown', function (e) {
        //alert("keypress");
        let key = e.key;
        customBox1.controlInput(key);
      })


      </script>
      </body>
    </html>
