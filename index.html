<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <link rel="stylesheet" href="index.css" />
  </head>
  <body>
    <canvas
      id="canvas_id"
      width= "220"
      height="240"
      style="border: 1px solid #550233"
      ;
    ></canvas>
    <button id="button1" onclick="insertNow()">insert position 2</button>



    <div class = "test"></div>


    <script>
      var ctx;
      var gX = 20;
      var gY = 20;
      var flag = 0;
    var textArray = new Array();

      var canvas = document.getElementById('canvas_id')

      document.addEventListener('keydown', function (e) {
        //alert("keypress");
        let key = e.key;
        controlInput(key);
      })

      



      /////////

      function controlInput(key) {

        //if (e == )ArrowRight
        textArray = textArray + key;
        //ctx.clearRect(0,0,300,300);
        gX = gX + 0;
        //ctx.clearRect(0,0,300,300);
        ctx.fillStyle = 'black';

        drawText();
      }

      function clearArray() {
        ctx.clearRect(0,0,100,100);
        ctx.fillStyle = '#bada55';
        ctx.fillRect(0,0, canvas.width, canvas.height);
        ctx.fillStyle = '#000000';
      }
      var indexX = 0;
      var currentKeyPress = '';
      
      
      let wrapAtX = 20;
      const MAXWIDTH = 5; 
      function drawText() {
        clearArray();

        
        
        
        
        gX = 0;
        


        gY = 20;
        
        //loops through entire string
        for (i = 0; i < textArray.length; i++) {


          //alert(i);
          //in here, at end 3,6,9,12 , etc.
          if((( i % 3) == 0) && (i != "0")){
            
            //sets new positioning for cursor
            
            gX = 5;
            gY = gY + 5;
            
            ctx.fillText(textArray[i], gX, gY);
            
           
            console.log("i2 " , gY );
          }
          else{

          //prints one character
          
          gX=gX + 5; 
          ctx.fillText(textArray[i], gX, gY);
         
          console.log("i1 " , i )
          console.log("gx", gX);
          
          
          }
          
        }
        
        drawCursor();
        
        
        
        
      }

      


      var xValuetoInsertAt = 2;
      newArray = [];
      
      




      ////////

      ////////

      //var canvas = document.getElementById('canvas_id');
      ctx = canvas.getContext('2d');
      // Set display size (css pixels).
      //get width of canvasvar size = 300;
      var size = 220;
      canvas.style.width = size + 'px';
      canvas.style.height = size + 'px';

      // Set actual size in memory (scaled to account for extra pixel density).
      var scale = window.devicePixelRatio; // Change to 1 on retina screens to see blurry canvas.
      canvas.width = size * scale;
      canvas.height = size * scale;

      // Normalize coordinate system to use css pixels.
      ctx.scale(scale, scale);

      ctx.fillStyle = '#bada55';
      ctx.fillRect(0, 0, 300, 300);
      ctx.fillStyle = '#000000';
      ctx.font = '9px Monospace';
      ctx.textAlign = 'center';
      ctx.textBaseline = 'middle';

      var x = size / 2;
      var y = size / 2;

      //var textString = "I love MDN";
      //ctx.fillText(textString, x, y);


      function insertNow(){
        let con = insert(textArray, 1, '5');
        console.log("con",con.length);


        //for(var i = 0 , len =con.length; i < len; i++){
        //textArray[i] = con[i];
        //console.log("1", textArray);
        textArray = [...con];
      
        

          
        
        drawText();
      }

      const insert = (arr, index, newItem) => [
      
        ...arr.slice(0, index),
        newItem,
        ...arr.slice(index)
        
    ]


    function drawCursor(){

//cursorImage = new Image();
//cursorImage.src = "images/cursor.bmp";
//ctx.drawImage(cursorImage, 40,40,40,40);

ctx.fillText('_', gX+5, gY+0);


}

      
      
      

      
      




      </script>
      </body>
    </html>
